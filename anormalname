-- Manual One-Tap Cyber Freeze (REAL LAG SYSTEM)
-- CYBER ICE THEME with Bloxstrap Integration & Dynamic Blur
-- by rii (I didn't made it js make it back to work)

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local Workspace = game:GetService("Workspace")

local Player = Players.LocalPlayer
local PlayerGui = Player:WaitForChild("PlayerGui")

-- Configuration
local FreezeDuration = 0.4
local Cooldown = 0.2
local LastFreezeTime = 0
local IsFreezing = false
local SettingsOpen = false
local DragEnabled = true

-- Remove old GUI if exists
if PlayerGui:FindFirstChild("LagSwitchUI") then
    PlayerGui.LagSwitchUI:Destroy()
end

-- Create CYBER ICE THEME GUI
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "LagSwitchUI"
ScreenGui.ResetOnSpawn = false
ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
ScreenGui.Parent = PlayerGui

-- Main Cyber Ice Container
local IceButton = Instance.new("Frame")
IceButton.Name = "IceButton"
IceButton.Size = UDim2.new(0, 200, 0, 80)
IceButton.Position = UDim2.new(0, 10, 0, 120)
IceButton.BackgroundColor3 = Color3.fromRGB(0, 20, 40)
IceButton.BackgroundTransparency = 0.3
IceButton.BorderSizePixel = 0
IceButton.Active = true
IceButton.Visible = true
IceButton.Parent = ScreenGui

-- Dynamic Blur Effect
local BlurEffect = Instance.new("BlurEffect")
BlurEffect.Name = "DynamicBlur"
BlurEffect.Size = 0
BlurEffect.Enabled = true
BlurEffect.Parent = IceButton

-- Settings Button
local SettingsButton = Instance.new("TextButton")
SettingsButton.Name = "SettingsButton"
SettingsButton.Size = UDim2.new(0, 25, 0, 25)
SettingsButton.Position = UDim2.new(1, -30, 0, 5)
SettingsButton.BackgroundColor3 = Color3.fromRGB(0, 40, 80)
SettingsButton.BackgroundTransparency = 0.2
SettingsButton.Text = "âš™"
SettingsButton.TextColor3 = Color3.fromRGB(0, 255, 255)
SettingsButton.TextSize = 14
SettingsButton.Font = Enum.Font.GothamBold
SettingsButton.BorderSizePixel = 0
SettingsButton.ZIndex = 10
SettingsButton.Parent = IceButton

local SettingsBorder = Instance.new("UIStroke")
SettingsBorder.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
SettingsBorder.Color = Color3.fromRGB(0, 200, 255)
SettingsBorder.Thickness = 2
SettingsBorder.Transparency = 0.1
SettingsBorder.Parent = SettingsButton

-- Cyber Ice Border
local CyberBorder = Instance.new("UIStroke")
CyberBorder.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
CyberBorder.Color = Color3.fromRGB(0, 255, 255)
CyberBorder.Thickness = 3
CyberBorder.Transparency = 0.1
CyberBorder.Parent = IceButton

-- Holographic Glow Effect
local GlowEffect = Instance.new("ImageLabel")
GlowEffect.Name = "GlowEffect"
GlowEffect.Size = UDim2.new(1.2, 0, 1.2, 0)
GlowEffect.Position = UDim2.new(-0.1, 0, -0.1, 0)
GlowEffect.BackgroundTransparency = 1
GlowEffect.Image = "rbxassetid://8992231221"
GlowEffect.ImageColor3 = Color3.fromRGB(0, 100, 255)
GlowEffect.ImageTransparency = 0.8
GlowEffect.ScaleType = Enum.ScaleType.Slice
GlowEffect.SliceCenter = Rect.new(100, 100, 100, 100)
GlowEffect.Parent = IceButton

-- Digital Grid Pattern
local GridPattern = Instance.new("Frame")
GridPattern.Name = "GridPattern"
GridPattern.Size = UDim2.new(1, 0, 1, 0)
GridPattern.BackgroundTransparency = 1
GridPattern.Parent = IceButton

for i = 1, 3 do
    local VerticalLine = Instance.new("Frame")
    VerticalLine.Size = UDim2.new(0, 1, 1, 0)
    VerticalLine.Position = UDim2.new(i/4, 0, 0, 0)
    VerticalLine.BackgroundColor3 = Color3.fromRGB(0, 150, 255)
    VerticalLine.BackgroundTransparency = 0.8
    VerticalLine.BorderSizePixel = 0
    VerticalLine.Parent = GridPattern
    
    local HorizontalLine = Instance.new("Frame")
    HorizontalLine.Size = UDim2.new(1, 0, 0, 1)
    HorizontalLine.Position = UDim2.new(0, 0, i/4, 0)
    HorizontalLine.BackgroundColor3 = Color3.fromRGB(0, 150, 255)
    HorizontalLine.BackgroundTransparency = 0.8
    HorizontalLine.BorderSizePixel = 0
    HorizontalLine.Parent = GridPattern
end

-- Scanner Line Effect
local ScannerLine = Instance.new("Frame")
ScannerLine.Size = UDim2.new(0, 2, 1, 0)
ScannerLine.Position = UDim2.new(0, -10, 0, 0)
ScannerLine.BackgroundColor3 = Color3.fromRGB(0, 255, 255)
ScannerLine.BorderSizePixel = 0
ScannerLine.Visible = false
ScannerLine.Parent = IceButton

-- ==================== SLOW MOTION BORDER FLOW ANIMATION ====================

-- Create border flow lines
local BorderFlowContainer = Instance.new("Frame")
BorderFlowContainer.Name = "BorderFlowContainer"
BorderFlowContainer.Size = UDim2.new(1, 0, 1, 0)
BorderFlowContainer.BackgroundTransparency = 1
BorderFlowContainer.ClipsDescendants = true
BorderFlowContainer.ZIndex = 3
BorderFlowContainer.Parent = IceButton

-- Top Border Line
local LineTop = Instance.new("Frame")
LineTop.Name = "LineTop"
LineTop.Size = UDim2.new(0, 0, 0, 2)
LineTop.Position = UDim2.new(0, 0, 0, 0)
LineTop.AnchorPoint = Vector2.new(0, 0)
LineTop.BackgroundColor3 = Color3.fromRGB(0, 255, 255)
LineTop.BorderSizePixel = 0
LineTop.ZIndex = 4
LineTop.Parent = BorderFlowContainer

local TopGlow = Instance.new("UIStroke")
TopGlow.Color = Color3.fromRGB(100, 255, 255)
TopGlow.Thickness = 3
TopGlow.Transparency = 0.3
TopGlow.Parent = LineTop

-- Right Border Line
local LineRight = Instance.new("Frame")
LineRight.Name = "LineRight"
LineRight.Size = UDim2.new(0, 2, 0, 0)
LineRight.Position = UDim2.new(1, 0, 0, 0)
LineRight.AnchorPoint = Vector2.new(1, 0)
LineRight.BackgroundColor3 = Color3.fromRGB(0, 255, 255)
LineRight.BorderSizePixel = 0
LineRight.ZIndex = 4
LineRight.Parent = BorderFlowContainer

local RightGlow = Instance.new("UIStroke")
RightGlow.Color = Color3.fromRGB(100, 255, 255)
RightGlow.Thickness = 3
RightGlow.Transparency = 0.3
RightGlow.Parent = LineRight

-- Bottom Border Line
local LineBottom = Instance.new("Frame")
LineBottom.Name = "LineBottom"
LineBottom.Size = UDim2.new(0, 0, 0, 2)
LineBottom.Position = UDim2.new(1, 0, 1, 0)
LineBottom.AnchorPoint = Vector2.new(1, 1)
LineBottom.BackgroundColor3 = Color3.fromRGB(0, 255, 255)
LineBottom.BorderSizePixel = 0
LineBottom.ZIndex = 4
LineBottom.Parent = BorderFlowContainer

local BottomGlow = Instance.new("UIStroke")
BottomGlow.Color = Color3.fromRGB(100, 255, 255)
BottomGlow.Thickness = 3
BottomGlow.Transparency = 0.3
BottomGlow.Parent = LineBottom

-- Left Border Line
local LineLeft = Instance.new("Frame")
LineLeft.Name = "LineLeft"
LineLeft.Size = UDim2.new(0, 2, 0, 0)
LineLeft.Position = UDim2.new(0, 0, 1, 0)
LineLeft.AnchorPoint = Vector2.new(0, 1)
LineLeft.BackgroundColor3 = Color3.fromRGB(0, 255, 255)
LineLeft.BorderSizePixel = 0
LineLeft.ZIndex = 4
LineLeft.Parent = BorderFlowContainer

local LeftGlow = Instance.new("UIStroke")
LeftGlow.Color = Color3.fromRGB(100, 255, 255)
LeftGlow.Thickness = 3
LeftGlow.Transparency = 0.3
LeftGlow.Parent = LineLeft

-- Slow Motion Border Flow Animation Function
local function StartSlowMotionBorderFlow()
    local SIDE_TIME = 1.2
    local PAUSE_BETWEEN_CYCLES = 2.0
    
    local function resetLines()
        LineTop.Size = UDim2.new(0, 0, 0, 2)
        LineRight.Size = UDim2.new(0, 2, 0, 0)
        LineBottom.Size = UDim2.new(0, 0, 0, 2)
        LineLeft.Size = UDim2.new(0, 2, 0, 0)
    end
    
    resetLines()
    
    local tweenInfo = TweenInfo.new(
        SIDE_TIME,
        Enum.EasingStyle.Quad,
        Enum.EasingDirection.Out,
        0,
        false,
        0
    )
    
    while IceButton and IceButton.Parent do
        local topTween = TweenService:Create(
            LineTop,
            tweenInfo,
            { Size = UDim2.new(1, 0, 0, 2) }
        )
        topTween:Play()
        topTween.Completed:Wait()

        local rightTween = TweenService:Create(
            LineRight,
            tweenInfo,
            { Size = UDim2.new(0, 2, 1, 0) }
        )
        rightTween:Play()
        rightTween.Completed:Wait()

        local bottomTween = TweenService:Create(
            LineBottom,
            tweenInfo,
            { Size = UDim2.new(1, 0, 0, 2) }
        )
        bottomTween:Play()
        bottomTween.Completed:Wait()

        local leftTween = TweenService:Create(
            LineLeft,
            tweenInfo,
            { Size = UDim2.new(0, 2, 1, 0) }
        )
        leftTween:Play()
        leftTween.Completed:Wait()

        resetLines()
        wait(PAUSE_BETWEEN_CYCLES)
    end
end

-- Cyber Style Button Text
local ButtonText = Instance.new("TextLabel")
ButtonText.Size = UDim2.new(1, 0, 1, 0)
ButtonText.Position = UDim2.new(0, 0, 0, 0)
ButtonText.Text = ""
ButtonText.Font = Enum.Font.SciFi
ButtonText.TextSize = 16
ButtonText.TextColor3 = Color3.fromRGB(0, 255, 255)
ButtonText.BackgroundTransparency = 1
ButtonText.TextStrokeTransparency = 0.2
ButtonText.TextStrokeColor3 = Color3.fromRGB(0, 0, 50)
ButtonText.ZIndex = 2
ButtonText.TextWrapped = true
ButtonText.TextYAlignment = Enum.TextYAlignment.Center
ButtonText.Parent = IceButton

-- Status Text
local StatusText = Instance.new("TextLabel")
StatusText.Name = "StatusText"
StatusText.Size = UDim2.new(1, 0, 0, 15)
StatusText.Position = UDim2.new(0, 0, 0.8, 0)
StatusText.Text = ""
StatusText.Font = Enum.Font.Code
StatusText.TextSize = 9
StatusText.TextColor3 = Color3.fromRGB(150, 255, 255)
StatusText.BackgroundTransparency = 1
StatusText.TextStrokeTransparency = 0.5
StatusText.ZIndex = 2
StatusText.Parent = IceButton

-- Click Detector
local ClickDetector = Instance.new("TextButton")
ClickDetector.Size = UDim2.new(1, 0, 1, 0)
ClickDetector.Position = UDim2.new(0, 0, 0, 0)
ClickDetector.BackgroundTransparency = 1
ClickDetector.Text = ""
ClickDetector.ZIndex = 5
ClickDetector.Parent = IceButton

-- ==================== SETTINGS PANEL DENGAN BLOXSTRAP ====================

-- Settings Panel yang lebih tinggi untuk muat Bloxstrap
local SettingsPanel = Instance.new("Frame")
SettingsPanel.Name = "SettingsPanel"
SettingsPanel.Size = UDim2.new(0, 220, 0, 220)  -- DIPERBESAR: 220x220 untuk muat Bloxstrap
SettingsPanel.Position = UDim2.new(1, 10, 0, 0)
SettingsPanel.BackgroundColor3 = Color3.fromRGB(0, 30, 60)
SettingsPanel.BackgroundTransparency = 0.1
SettingsPanel.BorderSizePixel = 0
SettingsPanel.Visible = false
SettingsPanel.ZIndex = 20
SettingsPanel.Parent = IceButton

local SettingsPanelBorder = Instance.new("UIStroke")
SettingsPanelBorder.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
SettingsPanelBorder.Color = Color3.fromRGB(0, 200, 255)
SettingsPanelBorder.Thickness = 2
SettingsPanelBorder.Transparency = 0.1
SettingsPanelBorder.Parent = SettingsPanel

-- Header Settings
local SettingsHeader = Instance.new("Frame")
SettingsHeader.Name = "SettingsHeader"
SettingsHeader.Size = UDim2.new(1, 0, 0, 25)
SettingsHeader.Position = UDim2.new(0, 0, 0, 0)
SettingsHeader.BackgroundColor3 = Color3.fromRGB(0, 50, 100)
SettingsHeader.BackgroundTransparency = 0.2
SettingsHeader.BorderSizePixel = 0
SettingsHeader.ZIndex = 21
SettingsHeader.Parent = SettingsPanel

local SettingsTitle = Instance.new("TextLabel")
SettingsTitle.Size = UDim2.new(1, 0, 1, 0)
SettingsTitle.Position = UDim2.new(0, 0, 0, 0)
SettingsTitle.Text = "SETTINGS"
SettingsTitle.Font = Enum.Font.SciFi
SettingsTitle.TextSize = 14
SettingsTitle.TextColor3 = Color3.fromRGB(0, 255, 255)
SettingsTitle.BackgroundTransparency = 1
SettingsTitle.TextStrokeTransparency = 0.3
SettingsTitle.ZIndex = 22
SettingsTitle.Parent = SettingsHeader

-- Content Container
local SettingsContent = Instance.new("Frame")
SettingsContent.Name = "SettingsContent"
SettingsContent.Size = UDim2.new(1, 0, 1, -25)
SettingsContent.Position = UDim2.new(0, 0, 0, 25)
SettingsContent.BackgroundTransparency = 1
SettingsContent.ZIndex = 21
SettingsContent.Parent = SettingsPanel

-- Freeze Duration Section
local DurationSection = Instance.new("Frame")
DurationSection.Name = "DurationSection"
DurationSection.Size = UDim2.new(1, -20, 0, 40)
DurationSection.Position = UDim2.new(0, 10, 0, 10)
DurationSection.BackgroundTransparency = 1
DurationSection.ZIndex = 21
DurationSection.Parent = SettingsContent

local DurationLabel = Instance.new("TextLabel")
DurationLabel.Size = UDim2.new(1, 0, 0, 15)
DurationLabel.Position = UDim2.new(0, 0, 0, 0)
DurationLabel.Text = "Duration (0.1-100s):"
DurationLabel.Font = Enum.Font.Code
DurationLabel.TextSize = 11
DurationLabel.TextColor3 = Color3.fromRGB(200, 255, 255)
DurationLabel.BackgroundTransparency = 1
DurationLabel.TextXAlignment = Enum.TextXAlignment.Left
DurationLabel.ZIndex = 22
DurationLabel.Parent = DurationSection

local DurationTextBox = Instance.new("TextBox")
DurationTextBox.Size = UDim2.new(1, 0, 0, 22)
DurationTextBox.Position = UDim2.new(0, 0, 0, 18)
DurationTextBox.BackgroundColor3 = Color3.fromRGB(0, 50, 100)
DurationTextBox.BackgroundTransparency = 0.2
DurationTextBox.TextColor3 = Color3.fromRGB(255, 255, 255)
DurationTextBox.Text = tostring(FreezeDuration)
DurationTextBox.Font = Enum.Font.Code
DurationTextBox.TextSize = 12
DurationTextBox.PlaceholderText = "seconds"
DurationTextBox.ZIndex = 22
DurationTextBox.Parent = DurationSection

-- Size Settings Section
local SizeSection = Instance.new("Frame")
SizeSection.Name = "SizeSection"
SizeSection.Size = UDim2.new(1, -20, 0, 40)
SizeSection.Position = UDim2.new(0, 10, 0, 55)
SizeSection.BackgroundTransparency = 1
SizeSection.ZIndex = 21
SizeSection.Parent = SettingsContent

local SizeLabel = Instance.new("TextLabel")
SizeLabel.Size = UDim2.new(1, 0, 0, 15)
SizeLabel.Position = UDim2.new(0, 0, 0, 0)
SizeLabel.Text = "Size (100-500px):"
SizeLabel.Font = Enum.Font.Code
SizeLabel.TextSize = 11
SizeLabel.TextColor3 = Color3.fromRGB(200, 255, 255)
SizeLabel.BackgroundTransparency = 1
SizeLabel.TextXAlignment = Enum.TextXAlignment.Left
SizeLabel.ZIndex = 22
SizeLabel.Parent = SizeSection

local SizeTextBox = Instance.new("TextBox")
SizeTextBox.Size = UDim2.new(1, 0, 0, 22)
SizeTextBox.Position = UDim2.new(0, 0, 0, 18)
SizeTextBox.BackgroundColor3 = Color3.fromRGB(0, 50, 100)
SizeTextBox.BackgroundTransparency = 0.2
SizeTextBox.TextColor3 = Color3.fromRGB(255, 255, 255)
SizeTextBox.Text = tostring(IceButton.Size.Width.Offset)
SizeTextBox.Font = Enum.Font.Code
SizeTextBox.TextSize = 12
SizeTextBox.PlaceholderText = "pixels"
SizeTextBox.ZIndex = 22
SizeTextBox.Parent = SizeSection

-- Drag Toggle Section
local DragSection = Instance.new("Frame")
DragSection.Name = "DragSection"
DragSection.Size = UDim2.new(1, -20, 0, 25)
DragSection.Position = UDim2.new(0, 10, 0, 100)
DragSection.BackgroundTransparency = 1
DragSection.ZIndex = 21
DragSection.Parent = SettingsContent

local DragToggleButton = Instance.new("TextButton")
DragToggleButton.Name = "DragToggleButton"
DragToggleButton.Size = UDim2.new(1, 0, 1, 0)
DragToggleButton.Position = UDim2.new(0, 0, 0, 0)
DragToggleButton.BackgroundColor3 = Color3.fromRGB(0, 150, 255)
DragToggleButton.BackgroundTransparency = 0.2
DragToggleButton.TextColor3 = Color3.fromRGB(255, 255, 255)
DragToggleButton.Text = "DRAG: ON"
DragToggleButton.TextSize = 11
DragToggleButton.Font = Enum.Font.SciFi
DragToggleButton.ZIndex = 22
DragToggleButton.Parent = DragSection

-- BLOXSTRAP Section - FITUR BARU
local BloxstrapSection = Instance.new("Frame")
BloxstrapSection.Name = "BloxstrapSection"
BloxstrapSection.Size = UDim2.new(1, -20, 0, 25)
BloxstrapSection.Position = UDim2.new(0, 10, 0, 130)
BloxstrapSection.BackgroundTransparency = 1
BloxstrapSection.ZIndex = 21
BloxstrapSection.Parent = SettingsContent

local BloxstrapButton = Instance.new("TextButton")
BloxstrapButton.Name = "BloxstrapButton"
BloxstrapButton.Size = UDim2.new(1, 0, 1, 0)
BloxstrapButton.Position = UDim2.new(0, 0, 0, 0)
BloxstrapButton.BackgroundColor3 = Color3.fromRGB(150, 0, 255)
BloxstrapButton.BackgroundTransparency = 0.2
BloxstrapButton.TextColor3 = Color3.fromRGB(255, 255, 255)
BloxstrapButton.Text = "LAUNCH BLOXSTRAP"
BloxstrapButton.TextSize = 11
BloxstrapButton.Font = Enum.Font.SciFi
BloxstrapButton.ZIndex = 22
BloxstrapButton.Parent = BloxstrapSection

-- Apply Button - DIPINDAHKAN ke bawah
local ApplyButton = Instance.new("TextButton")
ApplyButton.Size = UDim2.new(1, -20, 0, 25)
ApplyButton.Position = UDim2.new(0, 10, 0, 165)
ApplyButton.BackgroundColor3 = Color3.fromRGB(0, 150, 255)
ApplyButton.BorderSizePixel = 0
ApplyButton.Text = "APPLY"
ApplyButton.TextColor3 = Color3.fromRGB(255, 255, 255)
ApplyButton.TextSize = 12
ApplyButton.Font = Enum.Font.SciFi
ApplyButton.ZIndex = 22
ApplyButton.Parent = SettingsContent

-- ==================== ANIMATIONS ====================

-- Boot-Up Animation
local function PlayBootAnimation()
    for i = 1, 3 do
        IceButton.BackgroundTransparency = 0.5
        wait(0.1)
        IceButton.BackgroundTransparency = 0.3
        wait(0.1)
    end
    
    ScannerLine.Visible = true
    local scannerSweep = TweenService:Create(ScannerLine, TweenInfo.new(0.8, Enum.EasingStyle.Quad), {Position = UDim2.new(1, 10, 0, 0)})
    scannerSweep:Play()
    scannerSweep.Completed:Connect(function()
        ScannerLine.Visible = false
    end)
    
    local function TypeText(textLabel, text, delay)
        textLabel.Text = ""
        for i = 1, #text do
            textLabel.Text = string.sub(text, 1, i)
            wait(delay)
        end
    end
    
    wait(0.3)
    task.spawn(TypeText, ButtonText, "CYBER FREEZE", 0.1)
    wait(0.5)
    task.spawn(TypeText, StatusText, "SYSTEM READY", 0.05)
end

-- Idle Animation
local function StartIdleAnimation()
    coroutine.wrap(function()
        while IceButton and IceButton.Parent do
            local pulseIn = TweenService:Create(CyberBorder, TweenInfo.new(3, Enum.EasingStyle.Sine), {Color = Color3.fromRGB(100, 255, 255)})
            local pulseOut = TweenService:Create(CyberBorder, TweenInfo.new(3, Enum.EasingStyle.Sine), {Color = Color3.fromRGB(0, 150, 255)})
            pulseIn:Play()
            pulseIn.Completed:Wait()
            pulseOut:Play()
            pulseOut.Completed:Wait()
        end
    end)()
    
    coroutine.wrap(function()
        while IceButton and IceButton.Parent do
            local glowIn = TweenService:Create(ButtonText, TweenInfo.new(2, Enum.EasingStyle.Sine), {TextStrokeTransparency = 0.1})
            local glowOut = TweenService:Create(ButtonText, TweenInfo.new(2, Enum.EasingStyle.Sine), {TextStrokeTransparency = 0.3})
            glowIn:Play()
            glowIn.Completed:Wait()
            glowOut:Play()
            glowOut.Completed:Wait()
        end
    end)()
    
    coroutine.wrap(function()
        while IceButton and IceButton.Parent do
            local tweenIn = TweenService:Create(GlowEffect, TweenInfo.new(3, Enum.EasingStyle.Sine), {ImageTransparency = 0.6})
            local tweenOut = TweenService:Create(GlowEffect, TweenInfo.new(3, Enum.EasingStyle.Sine), {ImageTransparency = 0.8})
            tweenIn:Play()
            tweenIn.Completed:Wait()
            tweenOut:Play()
            tweenOut.Completed:Wait()
        end
    end)()
end

-- ==================== DYNAMIC BLUR FUNCTIONS ====================

local function EnableBlurEffect()
    local blurTween = TweenService:Create(
        BlurEffect,
        TweenInfo.new(0.5, Enum.EasingStyle.Quad, Enum.EasingDirection.Out),
        {Size = 8}
    )
    blurTween:Play()
    
    local darkenTween = TweenService:Create(
        IceButton,
        TweenInfo.new(0.5, Enum.EasingStyle.Quad, Enum.EasingDirection.Out),
        {BackgroundTransparency = 0.5}
    )
    darkenTween:Play()
end

local function DisableBlurEffect()
    local blurTween = TweenService:Create(
        BlurEffect,
        TweenInfo.new(0.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out),
        {Size = 0}
    )
    blurTween:Play()
    
    local restoreTween = TweenService:Create(
        IceButton,
        TweenInfo.new(0.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out),
        {BackgroundTransparency = 0.3}
    )
    restoreTween:Play()
end

-- ==================== BLOXSTRAP INTEGRATION ====================

local function LaunchBloxstrap()
    -- Visual feedback
    BloxstrapButton.BackgroundColor3 = Color3.fromRGB(255, 150, 0)
    BloxstrapButton.Text = "LOADING BLOXSTRAP..."
    StatusText.Text = "INITIALIZING BLOXSTRAP"
    
    -- Bloxstrap configuration
    getgenv().autosetup = {
        path = 'Bloxstrap',
        setup = true
    }
    
    -- Execute Bloxstrap
    local success, errorMsg = pcall(function()
        loadstring(game:HttpGet('https://raw.githubusercontent.com/qwertyui-is-back/Bloxstrap/main/Initiate.lua', true))()
    end)
    
    if success then
        BloxstrapButton.BackgroundColor3 = Color3.fromRGB(0, 200, 0)
        BloxstrapButton.Text = "BLOXSTRAP LOADED!"
        StatusText.Text = "BLOXSTRAP READY"
        
        print("âœ… Bloxstrap loaded successfully!")
    else
        BloxstrapButton.BackgroundColor3 = Color3.fromRGB(200, 0, 0)
        BloxstrapButton.Text = "LOAD FAILED!"
        StatusText.Text = "BLOXSTRAP ERROR"
        
        warn("âŒ Bloxstrap loading failed: " .. tostring(errorMsg))
    end
    
    -- Reset button after 3 seconds
    wait(3)
    if not IsFreezing then
        StatusText.Text = "SYSTEM READY"
    end
    BloxstrapButton.BackgroundColor3 = Color3.fromRGB(150, 0, 255)
    BloxstrapButton.Text = "LAUNCH BLOXSTRAP"
end

-- ==================== SETTINGS FUNCTIONS ====================

local function updateFreezeDuration(value)
    local numValue = tonumber(value)
    if numValue and numValue >= 0.1 and numValue <= 100 then
        FreezeDuration = numValue
        DurationTextBox.Text = tostring(FreezeDuration)
        return true
    else
        DurationTextBox.Text = tostring(FreezeDuration)
        return false
    end
end

local function updateButtonSize(value)
    local numValue = tonumber(value)
    if numValue and numValue >= 100 and numValue <= 500 then
        local newSize = numValue
        IceButton.Size = UDim2.new(0, newSize, 0, newSize * 0.45)
        SizeTextBox.Text = tostring(newSize)
        
        ButtonText.TextSize = math.clamp(newSize / 12, 12, 24)
        StatusText.TextSize = math.clamp(newSize / 20, 8, 14)
        return true
    else
        SizeTextBox.Text = tostring(IceButton.Size.Width.Offset)
        return false
    end
end

-- Toggle Drag Function
local function toggleDrag()
    DragEnabled = not DragEnabled
    if DragEnabled then
        DragToggleButton.Text = "DRAG: ON"
        DragToggleButton.BackgroundColor3 = Color3.fromRGB(0, 150, 255)
        StatusText.Text = "DRAG ENABLED"
    else
        DragToggleButton.Text = "DRAG: OFF"
        DragToggleButton.BackgroundColor3 = Color3.fromRGB(150, 0, 0)
        StatusText.Text = "DRAG DISABLED"
    end
    
    wait(2)
    if not IsFreezing then
        StatusText.Text = "SYSTEM READY"
    end
end

local function toggleSettings()
    SettingsOpen = not SettingsOpen
    SettingsPanel.Visible = SettingsOpen

    if SettingsOpen then
        SettingsButton.TextColor3 = Color3.fromRGB(255, 255, 0)
        DurationTextBox.Text = tostring(FreezeDuration)
        SizeTextBox.Text = tostring(IceButton.Size.Width.Offset)
        EnableBlurEffect()
    else
        SettingsButton.TextColor3 = Color3.fromRGB(0, 255, 255)
        DisableBlurEffect()
    end
end

SettingsButton.MouseButton1Click:Connect(toggleSettings)
DragToggleButton.MouseButton1Click:Connect(toggleDrag)
BloxstrapButton.MouseButton1Click:Connect(LaunchBloxstrap)  -- FITUR BARU: Connect Bloxstrap button

ApplyButton.MouseButton1Click:Connect(function()
    local durationSuccess = updateFreezeDuration(DurationTextBox.Text)
    local sizeSuccess = updateButtonSize(SizeTextBox.Text)
    
    if durationSuccess and sizeSuccess then
        ApplyButton.BackgroundColor3 = Color3.fromRGB(0, 200, 0)
        ApplyButton.Text = "APPLIED!"
        wait(1)
        ApplyButton.BackgroundColor3 = Color3.fromRGB(0, 150, 255)
        ApplyButton.Text = "APPLY"
    else
        ApplyButton.BackgroundColor3 = Color3.fromRGB(200, 0, 0)
        ApplyButton.Text = "INVALID!"
        wait(1)
        ApplyButton.BackgroundColor3 = Color3.fromRGB(0, 150, 255)
        ApplyButton.Text = "APPLY"
    end
end)

DurationTextBox.FocusLost:Connect(function(enterPressed)
    if enterPressed then
        updateFreezeDuration(DurationTextBox.Text)
    end
end)

SizeTextBox.FocusLost:Connect(function(enterPressed)
    if enterPressed then
        updateButtonSize(SizeTextBox.Text)
    end
end)

-- ==================== DRAG FUNCTIONALITY ====================

local dragging = false
local dragStart, startPos

local function startDrag(input)
    if SettingsOpen or not DragEnabled then return end
    dragging = true
    dragStart = input.Position
    startPos = IceButton.Position
end

local function updateDrag(input)
    if dragging and DragEnabled then
        local delta = input.Position - dragStart
        IceButton.Position = UDim2.new(
            startPos.X.Scale,
            startPos.X.Offset + delta.X,
            startPos.Y.Scale,
            startPos.Y.Offset + delta.Y
        )
    end
end

local function endDrag()
    dragging = false
end

ClickDetector.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.Touch or input.UserInputType == Enum.UserInputType.MouseButton1 then
        startDrag(input)
    end
end)

ClickDetector.InputChanged:Connect(function(input)
    if dragging and (input.UserInputType == Enum.UserInputType.Touch or input.UserInputType == Enum.UserInputType.MouseMovement) then
        updateDrag(input)
    end
end)

ClickDetector.InputEnded:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.Touch or input.UserInputType == Enum.UserInputType.MouseButton1 then
        endDrag()
    end
end)

-- ==================== REAL LAG SYSTEM ====================

local function TriggerFreeze()
    local currentTime = tick()
    
    if currentTime - LastFreezeTime < Cooldown then
        return
    end
    
    local Character = Player.Character
    if not Character then return end
    
    local Humanoid = Character:FindFirstChild("Humanoid")
    local HumanoidRootPart = Character:FindFirstChild("HumanoidRootPart")
    
    if not Humanoid or Humanoid.Health <= 0 or not HumanoidRootPart then
        return
    end
    
    IsFreezing = true
    LastFreezeTime = currentTime
    
    local startTime = os.clock()
    
    -- Visual feedback
    ButtonText.Text = "OVERLOADING..."
    StatusText.Text = "SYSTEM CRITICAL"
    IceButton.BackgroundColor3 = Color3.fromRGB(0, 50, 80)
    CyberBorder.Color = Color3.fromRGB(255, 50, 100)
    
    local intenseGlow = TweenService:Create(
        GlowEffect,
        TweenInfo.new(0.2, Enum.EasingStyle.Quad),
        {ImageTransparency = 0.3, ImageColor3 = Color3.fromRGB(255, 0, 100)}
    )
    intenseGlow:Play()

    -- REAL LAG GENERATION
    local function causeOptimizedLag()
        local parts = {}
        local connections = {}
        
        local partCount = math.min(50 + (FreezeDuration * 10), 200)
        for i = 1, partCount do
            local part = Instance.new("Part")
            part.Anchored = true
            part.CanCollide = false
            part.Transparency = 1
            part.Size = Vector3.new(1, 1, 1)
            part.Position = HumanoidRootPart.Position + Vector3.new(math.random(-20, 20), math.random(-10, 10), math.random(-20, 20))
            part.Parent = workspace
            
            part.Velocity = Vector3.new(math.random(-10, 10), math.random(-10, 10), math.random(-10, 10))
            
            table.insert(parts, part)
            
            local conn = part.Changed:Connect(function()
            end)
            table.insert(connections, conn)
        end
        
        while os.clock() - startTime < FreezeDuration do
            local iterations = math.min(400 + (FreezeDuration * 100), 2000)
            for j = 1, iterations do
                local x = math.sqrt(j) * math.sin(j) * math.cos(j)
            end
            
            if os.clock() - startTime > FreezeDuration * 0.5 then
                RunService.Heartbeat:Wait()
            end
        end
        
        for _, part in ipairs(parts) do
            part:Destroy()
        end
        for _, conn in ipairs(connections) do
            conn:Disconnect()
        end
    end
    
    local success, err = pcall(causeOptimizedLag)
    if not success then
        warn("Lag generation error: " .. tostring(err))
        local start = os.clock()
        while os.clock() - start < FreezeDuration do
            RunService.Heartbeat:Wait()
        end
    end
    
    -- Reset visuals
    ButtonText.Text = "CYBER FREEZE"
    StatusText.Text = "SYSTEM READY"
    IceButton.BackgroundColor3 = Color3.fromRGB(0, 20, 40)
    CyberBorder.Color = Color3.fromRGB(0, 255, 255)
    
    local resetGlow = TweenService:Create(
        GlowEffect,
        TweenInfo.new(0.5, Enum.EasingStyle.Quad),
        {ImageTransparency = 0.8, ImageColor3 = Color3.fromRGB(0, 100, 255)}
    )
    resetGlow:Play()

    IsFreezing = false
end

-- Manual trigger
ClickDetector.MouseButton1Click:Connect(function()
    if not SettingsOpen then
        TriggerFreeze()
    end
end)

-- Keyboard shortcut
UserInputService.InputBegan:Connect(function(input, gameProcessed)
    if gameProcessed then return end
    if input.KeyCode == Enum.KeyCode.F then
        TriggerFreeze()
    end
end)

-- Auto-update character reference
Player.CharacterAdded:Connect(function(character)
    character:WaitForChild("Humanoid")
end)

-- Start animations
wait(0.5)
PlayBootAnimation()
wait(1)
StartIdleAnimation()
StartSlowMotionBorderFlow()

print("âœ… Cyber Freeze System Loaded Successfully!")
print("ðŸ–±ï¸ Click the button to activate freeze")
print("âš™ï¸ Click the gear icon for settings")
print("âŒ¨ï¸ Press F key for quick freeze")
print("ðŸ“ Size settings available (100-500px)")
print("ðŸŽ¬ SLOW MOTION Animations: Boot-up, Pulse, Border Flow")
print("ðŸŒ Border Flow: Ultra slow energy flow (1.2s per side)")
print("ðŸ“ UI Size: Main 200x80, Settings 220x220")
print("â±ï¸ Credit: lol")
print("ðŸ”„ Drag Toggle: Enable/disable GUI dragging")
print("ðŸŒ€ DYNAMIC BLUR: Panel blurs when settings open")
print("ðŸš€ BLOXSTRAP: Integrated launcher in settings")
print("ðŸ‘¤ Created by: me")
